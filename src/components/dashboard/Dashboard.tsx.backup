'use client';
import React from 'react';
import { StatCard } from './StatCard';
import { Article, Mouvement, Contact } from '@/types';

export function Dashboard({ stats, mouvements, articles, clients, fournisseurs }: { 
  stats: any; 
  mouvements: Mouvement[]; 
  articles: Article[]; 
  clients: Contact[]; 
  fournisseurs: Contact[]; 
}) {
  return (
    <div>
      <h2 className="text-3xl font-bold mb-6">Dashboard</h2>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <StatCard title="Ventes Totales" value={`${stats.totalVentes} €`} color="green" />
        <StatCard title="Achats Totaux" value={`${stats.totalAchats} €`} color="red" />
        <StatCard title="Valeur Stock" value={`${stats.valeurStock} €`} color="blue" />
        <StatCard title="Articles" value={stats.nombreArticles} color="purple" />
      </div>
      {stats.articlesFaibleStock > 0 && (
        <div className="bg-orange-100 border-l-4 border-orange-500 p-4 mb-6">
          <p className="font-bold">⚠️ Alerte Stock</p>
          <p>{stats.articlesFaibleStock} article(s) ont un stock inférieur à 10 unités</p>
        </div>
      )}
      <div className="bg-white rounded-lg shadow p-6">
        <h3 className="text-xl font-bold mb-4">Derniers Mouvements</h3>
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50">
              <tr>
                <th className="p-3 text-left">Date</th>
                <th className="p-3 text-left">Type</th>
                <th className="p-3 text-left">Article</th>
                <th className="p-3 text-left">Quantité</th>
                <th className="p-3 text-left">Contact</th>
              </tr>
            </thead>
            <tbody>
              {mouvements.slice(-5).reverse().map((mouv) => {
                const article = articles.find(a => a.id === mouv.articleId);
                const contact = mouv.type === 'vente' ? clients.find(c => c.id === mouv.clientId) : fournisseurs.find(f => f.id === mouv.fournisseurId);
                return (
                  <tr key={mouv.id} className="border-b hover:bg-gray-50">
                    <td className="p-3">{mouv.date}</td>
                    <td className="p-3">
                      <span className={`px-2 py-1 rounded text-xs ${mouv.type === 'entree' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}`}>{mouv.type}</span>
                    </td>
                    <td className="p-3">{article?.nom}</td>
                    <td className="p-3">{mouv.quantite}</td>
                    <td className="p-3">{contact?.societe || contact?.nom}</td>
                  </tr>
                );
              })}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}